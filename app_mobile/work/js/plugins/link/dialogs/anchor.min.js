CKEDITOR.dialog.add("anchor",function(b){function a(c,d){return c.createFakeElement(c.document.createElement("a",{attributes:d}),"cke_anchor","anchor")}return{title:b.lang.link.anchor.title,minWidth:300,minHeight:60,getModel:function(c){var d=c.getSelection();c=d.getRanges()[0];d=d.getSelectedElement();c.shrink(CKEDITOR.SHRINK_ELEMENT);(d=c.getEnclosedNode())&&d.type===CKEDITOR.NODE_TEXT&&(d=d.getParent());c=d&&d.type===CKEDITOR.NODE_ELEMENT&&("anchor"===d.data("cke-real-element-type")||d.is("a"))?d:void 0;return c||null},onOk:function(){var c=CKEDITOR.tools.trim(this.getValueOf("info","txtName")),c={id:c,name:c,"data-cke-saved-name":c},d=this.getModel(b);d?d.data("cke-realelement")?(c=a(b,c),c.replace(d),CKEDITOR.env.ie&&b.getSelection().selectElement(c)):d.setAttributes(c):(d=(d=b.getSelection())&&d.getRanges()[0],d.collapsed?(c=a(b,c),d.insertNode(c)):(CKEDITOR.env.ie&&9>CKEDITOR.env.version&&(c["class"]="cke_anchor"),c=new CKEDITOR.style({element:"a",attributes:c}),c.type=CKEDITOR.STYLE_INLINE,c.applyToRange(d)))},onShow:function(){var c=b.getSelection(),f=this.getModel(b),h=f&&f.data("cke-realelement");if(f=h?CKEDITOR.plugins.link.tryRestoreFakeAnchor(b,f):CKEDITOR.plugins.link.getSelectedLink(b)){var g=f.data("cke-saved-name");this.setValueOf("info","txtName",g||"");!h&&c.selectElement(f)}this.getContentElement("info","txtName").focus()},contents:[{id:"info",label:b.lang.link.anchor.title,accessKey:"I",elements:[{type:"text",id:"txtName",label:b.lang.link.anchor.name,required:!0,validate:function(){return this.getValue()?!0:(alert(b.lang.link.anchor.errorName),!1)}}]}]}});