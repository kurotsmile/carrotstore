(function(b,a){"object"===typeof exports&&"undefined"!==typeof module?module.exports=a():"function"===typeof define&&define.amd?define(a):b.ES6Promise=a()})(this,function(){function ax(g){return"function"===typeof g}function aw(){return function(){return process.nextTick(aD)}}function o(){return"undefined"!==typeof ap?function(){ap(aD)}:ao()}function j(){var h=0,g=new ah(aD),k=document.createTextNode("");g.observe(k,{characterData:!0});return function(){k.data=h=++h%2}}function i(){var g=new MessageChannel;g.port1.onmessage=aD;return function(){return g.port2.postMessage(0)}}function ao(){var g=setTimeout;return function(){return g(aD,1)}}function aD(){for(var g=0;g<aG;g+=2){(0,aB[g])(aB[g+1]),aB[g]=void 0,aB[g+1]=void 0}aG=0}function f(){try{var h=Function("return this")().require("vertx");ap=h.runOnLoop||h.runOnContext;return o()}catch(g){return ao()}}function an(h,g){var n=this,m=new this.constructor(aA);void 0===m[at]&&ag(m);var l=n._state;if(l){var k=arguments[l-1];aF(function(){return af(l,m,k,n._result)})}else{am(n,m,h,g)}return m}function al(h){if(h&&"object"===typeof h&&h.constructor===this){return h}var g=new this(aA);av(g,h);return g}function aA(){}function ae(h){try{return h.then}catch(g){return aC.error=g,aC}}function e(h,g,m,l){try{h.call(g,m,l)}catch(k){return k}}function d(h,g,k){aF(function(l){var n=!1,m=e(k,g,function(p){n||(n=!0,g!==p?av(l,p):aE(l,p))},function(p){n||(n=!0,aI(l,p))},"Settle: "+(l._label||" unknown promise"));!n&&m&&(n=!0,aI(l,m))},h)}function c(h,g){g._state===au?aE(h,g._result):g._state===az?aI(h,g._result):am(g,void 0,function(k){return av(h,k)},function(k){return aI(h,k)})}function ad(h,g,k){g.constructor===h.constructor&&k===an&&g.constructor.resolve===al?c(h,g):k===aC?(aI(h,aC.error),aC.error=null):void 0===k?aE(h,g):ax(k)?d(h,g,k):aE(h,g)}function av(h,g){if(h===g){aI(h,new TypeError("You cannot resolve a promise with itself"))}else{var k=typeof g;null===g||"object"!==k&&"function"!==k?aE(h,g):ad(h,g,ae(g))}}function b(g){g._onerror&&g._onerror(g._result);ak(g)}function aE(h,g){h._state===ay&&(h._result=g,h._state=au,0!==h._subscribers.length&&aF(ak,h))}function aI(h,g){h._state===ay&&(h._state=az,h._result=g,aF(b,h))}function am(h,g,n,m){var l=h._subscribers,k=l.length;h._onerror=null;l[k]=g;l[k+au]=n;l[k+az]=m;0===k&&h._state&&aF(ak,h)}function ak(k){var h=k._subscribers,q=k._state;if(0!==h.length){for(var p=void 0,n=void 0,m=k._result,l=0;l<h.length;l+=3){p=h[l],n=h[l+q],p?af(q,p,n,m):n(m)}k._subscribers.length=0}}function af(x,w,v,u){var t=ax(v),r=void 0,q=void 0,p=void 0,m=void 0;if(t){try{r=v(u)}catch(g){aC.error=g,r=aC}r===aC?(m=!0,q=r.error,r.error=null):p=!0;if(w===r){aI(w,new TypeError("A promises callback cannot return that same promise."));return}}else{r=u,p=!0}w._state===ay&&(t&&p?av(w,r):m?aI(w,q):x===au?aE(w,r):x===az&&aI(w,r))}function a(h,g){try{g(function(l){av(h,l)},function(l){aI(h,l)})}catch(k){aI(h,k)}}function ag(g){g[at]=ac++;g._state=void 0;g._result=void 0;g._subscribers=[]}var aj=void 0,ab=aj=Array.isArray?Array.isArray:function(g){return"[object Array]"===Object.prototype.toString.call(g)},aG=0,ap=void 0,ai=void 0,aF=function(h,g){aB[aG]=h;aB[aG+1]=g;aG+=2;2===aG&&(ai?ai(aD):s())},aq=(aj="undefined"!==typeof window?window:void 0)||{},ah=aq.MutationObserver||aq.WebKitMutationObserver,aq="undefined"===typeof self&&"undefined"!==typeof process&&"[object process]"==={}.toString.call(process),ar="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,aB=Array(1000),s=void 0,s=aq?aw():ah?j():ar?i():void 0===aj&&"function"===typeof require?f():ao(),at=Math.random().toString(36).substring(2),ay=void 0,au=1,az=2,aC={error:null},ac=0,aJ=function(){function g(h,k){this._instanceConstructor=h;this.promise=new h(aA);this.promise[at]||ag(this.promise);ab(k)?(this._remaining=this.length=k.length,this._result=Array(this.length),0===this.length?aE(this.promise,this._result):(this.length=this.length||0,this._enumerate(k),0===this._remaining&&aE(this.promise,this._result))):aI(this.promise,Error("Array Methods must be provided an Array"))}g.prototype._enumerate=function(h){for(var k=0;this._state===ay&&k<h.length;k++){this._eachEntry(h[k],k)}};g.prototype._eachEntry=function(h,m){var l=this._instanceConstructor,k=l.resolve;k===al?(k=ae(h),k===an&&h._state!==ay?this._settledAt(h._state,m,h._result):"function"!==typeof k?(this._remaining--,this._result[m]=h):l===aH?(l=new l(aA),ad(l,h,k),this._willSettleAt(l,m)):this._willSettleAt(new l(function(n){return n(h)}),m)):this._willSettleAt(k(h),m)};g.prototype._settledAt=function(h,m,l){var k=this.promise;k._state===ay&&(this._remaining--,h===az?aI(k,l):this._result[m]=l);0===this._remaining&&aE(k,this._result)};g.prototype._willSettleAt=function(h,l){var k=this;am(h,void 0,function(m){return k._settledAt(au,l,m)},function(m){return k._settledAt(az,l,m)})};return g}(),aH=function(){function g(h){this[at]=ac++;this._result=this._state=void 0;this._subscribers=[];if(aA!==h){if("function"!==typeof h){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}if(this instanceof g){a(this,h)}else{throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}}}g.prototype["catch"]=function(h){return this.then(null,h)};g.prototype["finally"]=function(h){var k=this.constructor;return ax(h)?this.then(function(l){return k.resolve(h()).then(function(){return l})},function(l){return k.resolve(h()).then(function(){throw l})}):this.then(h,h)};return g}();aH.prototype.then=an;aH.all=function(g){return(new aJ(this,g)).promise};aH.race=function(h){var g=this;return ab(h)?new g(function(n,m){for(var l=h.length,k=0;k<l;k++){g.resolve(h[k]).then(n,m)}}):new g(function(l,k){return k(new TypeError("You must pass an array to race."))})};aH.resolve=al;aH.reject=function(h){var g=new this(aA);aI(g,h);return g};aH._setScheduler=function(g){ai=g};aH._setAsap=function(g){aF=g};aH._asap=aF;aH.polyfill=function(){var h=void 0;if("undefined"!==typeof global){h=global}else{if("undefined"!==typeof self){h=self}else{try{h=Function("return this")()}catch(g){throw Error("polyfill failed because global object is unavailable in this environment")}}}var m=h.Promise;if(m){var l=null;try{l=Object.prototype.toString.call(m.resolve())}catch(k){}if("[object Promise]"===l&&!m.cast){return}}h.Promise=aH};return aH.Promise=aH});