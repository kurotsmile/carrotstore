CKEDITOR.dialog.add("specialchar",function(k){var e,n=k.lang.specialchar,m=function(a){var b;a=a.data?a.data.getTarget():new CKEDITOR.dom.element(a);"a"==a.getName()&&(b=a.getChild(0).getHtml())&&(a.removeClass("cke_light_background"),e.hide(),a=k.document.createElement("span"),a.setHtml(b),k.insertText(a.getText()))},p=CKEDITOR.tools.addFunction(m),l,g=function(a,f){var c;f=f||a.data.getTarget();"span"==f.getName()&&(f=f.getParent());if("a"==f.getName()&&(c=f.getChild(0).getHtml())){l&&d(null,l);var b=e.getContentElement("info","htmlPreview").getElement();e.getContentElement("info","charPreview").getElement().setHtml(c);b.setHtml(CKEDITOR.tools.htmlEncode(c));f.getParent().addClass("cke_light_background");l=f}},d=function(a,b){b=b||a.data.getTarget();"span"==b.getName()&&(b=b.getParent());"a"==b.getName()&&(e.getContentElement("info","charPreview").getElement().setHtml("\x26nbsp;"),e.getContentElement("info","htmlPreview").getElement().setHtml("\x26nbsp;"),b.getParent().removeClass("cke_light_background"),l=void 0)},q=CKEDITOR.tools.addFunction(function(a){a=new CKEDITOR.dom.event(a);var f=a.getTarget(),c;c=a.getKeystroke();var b="rtl"==k.lang.dir;switch(c){case 38:if(c=f.getParent().getParent().getPrevious()){c=c.getChild([f.getParent().getIndex(),0]),c.focus(),d(null,f),g(null,c)}a.preventDefault();break;case 40:(c=f.getParent().getParent().getNext())&&(c=c.getChild([f.getParent().getIndex(),0]))&&1==c.type&&(c.focus(),d(null,f),g(null,c));a.preventDefault();break;case 32:m({data:a});a.preventDefault();break;case b?37:39:if(c=f.getParent().getNext()){c=c.getChild(0),1==c.type?(c.focus(),d(null,f),g(null,c),a.preventDefault(!0)):d(null,f)}else{if(c=f.getParent().getParent().getNext()){(c=c.getChild([0,0]))&&1==c.type?(c.focus(),d(null,f),g(null,c),a.preventDefault(!0)):d(null,f)}}break;case b?39:37:(c=f.getParent().getPrevious())?(c=c.getChild(0),c.focus(),d(null,f),g(null,c),a.preventDefault(!0)):(c=f.getParent().getParent().getPrevious())?(c=c.getLast().getChild(0),c.focus(),d(null,f),g(null,c),a.preventDefault(!0)):d(null,f)}});return{title:n.title,minWidth:430,minHeight:280,buttons:[CKEDITOR.dialog.cancelButton],charColumns:17,onLoad:function(){for(var j=this.definition.charColumns,i=k.config.specialChars,h=CKEDITOR.tools.getNextId()+"_specialchar_table_label",y=['\x3ctable role\x3d"listbox" aria-labelledby\x3d"'+h+'" style\x3d"width: 320px; height: 100%; border-collapse: separate;" align\x3d"center" cellspacing\x3d"2" cellpadding\x3d"2" border\x3d"0"\x3e'],o=0,a=i.length,b,r;o<a;){y.push('\x3ctr role\x3d"presentation"\x3e');for(var c=0;c<j;c++,o++){if(b=i[o]){b instanceof Array?(r=b[1],b=b[0]):(r=b.replace("\x26","").replace(";","").replace("#",""),r=n[r]||b);var f="cke_specialchar_label_"+o+"_"+CKEDITOR.tools.getNextNumber();y.push('\x3ctd class\x3d"cke_dark_background" style\x3d"cursor: default" role\x3d"presentation"\x3e\x3ca href\x3d"javascript: void(0);" role\x3d"option" aria-posinset\x3d"'+(o+1)+'"',' aria-setsize\x3d"'+a+'"',' aria-labelledby\x3d"'+f+'"',' class\x3d"cke_specialchar" title\x3d"',CKEDITOR.tools.htmlEncode(r),'" onkeydown\x3d"CKEDITOR.tools.callFunction( '+q+', event, this )" onclick\x3d"CKEDITOR.tools.callFunction('+p+', this); return false;" tabindex\x3d"-1"\x3e\x3cspan style\x3d"margin: 0 auto;cursor: inherit"\x3e'+b+'\x3c/span\x3e\x3cspan class\x3d"cke_voice_label" id\x3d"'+f+'"\x3e'+r+"\x3c/span\x3e\x3c/a\x3e")}else{y.push('\x3ctd class\x3d"cke_dark_background"\x3e\x26nbsp;')}y.push("\x3c/td\x3e")}y.push("\x3c/tr\x3e")}y.push("\x3c/tbody\x3e\x3c/table\x3e",'\x3cspan id\x3d"'+h+'" class\x3d"cke_voice_label"\x3e'+n.options+"\x3c/span\x3e");this.getContentElement("info","charContainer").getElement().setHtml(y.join(""))},contents:[{id:"info",label:k.lang.common.generalTab,title:k.lang.common.generalTab,padding:0,align:"top",elements:[{type:"hbox",align:"top",widths:["320px","90px"],children:[{type:"html",id:"charContainer",html:"",onMouseover:g,onMouseout:d,focus:function(){var a=this.getElement().getElementsByTag("a").getItem(0);setTimeout(function(){a.focus();g(null,a)},0)},onShow:function(){var a=this.getElement().getChild([0,0,0,0,0]);setTimeout(function(){a.focus();g(null,a)},0)},onLoad:function(a){e=a.sender}},{type:"hbox",align:"top",widths:["100%"],children:[{type:"vbox",align:"top",children:[{type:"html",html:"\x3cdiv\x3e\x3c/div\x3e"},{type:"html",id:"charPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:28px;height:40px;width:70px;padding-top:9px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"\x3cdiv\x3e\x26nbsp;\x3c/div\x3e"},{type:"html",id:"htmlPreview",className:"cke_dark_background",style:"border:1px solid #eeeeee;font-size:14px;height:20px;width:70px;padding-top:2px;font-family:'Microsoft Sans Serif',Arial,Helvetica,Verdana;text-align:center;",html:"\x3cdiv\x3e\x26nbsp;\x3c/div\x3e"}]}]}]}]}]}});