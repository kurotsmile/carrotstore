(function(){function c(n){n=n.toUpperCase();for(var r=a.length,m=0,o=0;o<r;++o){for(var q=a[o],p=q[1].length;n.substr(0,p)==q[1];n=n.substr(p)){m+=q[0]}}return m}function l(n){n=n.toUpperCase();for(var o=1,m=1;0<n.length;m*=26){o+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(n.charAt(n.length-1))*m,n=n.substr(0,n.length-1)}return o}var k=CKEDITOR.htmlParser.fragment.prototype,b=CKEDITOR.htmlParser.element.prototype;k.onlyChild=b.onlyChild=function(){var m=this.children;return 1==m.length&&m[0]||null};b.removeAnyChildWithName=function(n){for(var q=this.children,m=[],o,p=0;p<q.length;p++){o=q[p],o.name&&(o.name==n&&(m.push(o),q.splice(p--,1)),m=m.concat(o.removeAnyChildWithName(n)))}return m};b.getAncestor=function(m){for(var n=this.parent;n&&(!n.name||!n.name.match(m));){n=n.parent}return n};k.firstChild=b.firstChild=function(n){for(var o,m=0;m<this.children.length;m++){if(o=this.children[m],n(o)||o.name&&(o=o.firstChild(n))){return o}}return null};b.addStyle=function(n,q,m){var o="";if("string"==typeof q){o+=n+":"+q+";"}else{if("object"==typeof n){for(var p in n){n.hasOwnProperty(p)&&(o+=p+":"+n[p]+";")}}else{o+=n}m=q}this.attributes||(this.attributes={});n=this.attributes.style||"";n=(m?[o,n]:[n,o]).join(";");this.attributes.style=n.replace(/^;+|;(?=;)/g,"")};b.getStyle=function(m){var n=this.attributes.style;if(n){return n=CKEDITOR.tools.parseCssText(n,1),n[m]}};CKEDITOR.dtd.parentOf=function(n){var o={},m;for(m in this){-1==m.indexOf("$")&&this[m][n]&&(o[m]=1)}return o};var j=/^(?:\b0[^\s]*\s*){1,4}$/,d={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},a=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],h=0,g=null,e,i=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(n,o){var m=new CKEDITOR.htmlParser.element("cke:listbullet");m.attributes={"cke:listsymbol":n[0]};m.add(new CKEDITOR.htmlParser.text(o));return m},isListBulletIndicator:function(m){if(/mso-list\s*:\s*Ignore/i.test(m.attributes&&m.attributes.style)){return !0}},isContainingOnlySpaces:function(m){var n;return(n=m.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(n.value)},resolveList:function(n){var o=n.attributes,m;if((m=n.removeAnyChildWithName("cke:listbullet"))&&m.length&&(m=m[0])){return n.name="cke:li",o.style&&(o.style=i.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(p){p=p.split(" ");p=CKEDITOR.tools.convertToPx(p[3]||p[1]||p[0]);!h&&null!==g&&p>g&&(h=p-g);g=p;o["cke:indent"]=h&&Math.ceil(p/h)+1||1}],[/^mso-list$/,null,function(q){q=q.split(" ");if(!(2>q.length)){var p=Number(q[0].match(/\d+/));q=Number(q[1].match(/\d+/));1==q&&(p!==e&&(o["cke:reset"]=1),e=p);o["cke:indent"]=q}}]])(o.style,n)||""),o["cke:indent"]||(g=0,o["cke:indent"]=1),CKEDITOR.tools.extend(o,m.attributes),!0}e=g=h=null;return !1},getStyleComponents:function(){var m=CKEDITOR.dom.element.createFromHtml('\x3cdiv style\x3d"position:absolute;left:-9999px;top:-9999px;"\x3e\x3c/div\x3e',CKEDITOR.document);CKEDITOR.document.getBody().append(m);return function(q,n,o){m.setStyle(q,n);q={};n=o.length;for(var p=0;p<n;p++){q[o[p]]=m.getStyle(o[p])}return q}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(x,v){v="number"==typeof v?v:1;var w=x.attributes,s;switch(w.type){case"a":s="lower-alpha";break;case"1":s="decimal"}for(var u=x.children,t,p=0;p<u.length;p++){if(t=u[p],t.name in CKEDITOR.dtd.$listItem){var o=t.attributes,r=t.children,m=r[0],q=r[r.length-1];m.attributes&&m.attributes.style&&-1<m.attributes.style.indexOf("mso-list")&&(t.attributes.style=m.attributes.style,m.replaceWithChildren());q.name in CKEDITOR.dtd.$list&&(x.add(q,p+1),--r.length||u.splice(p--,1));t.name="cke:li";w.start&&!p&&(o.value=w.start);i.filters.stylesFilter([["tab-stops",null,function(n){(n=n.match(/0$|\d+\.?\d*\w+/))&&(g=CKEDITOR.tools.convertToPx(n[0]))}],1==v?["mso-list",null,function(n){n=n.split(" ");n=Number(n[0].match(/\d+/));n!==e&&(o["cke:reset"]=1);e=n}]:null])(o.style);o["cke:indent"]=v;o["cke:listtype"]=x.name;o["cke:list-style-type"]=s}else{if(t.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[t,v+1]);u=u.slice(0,p).concat(t.children).concat(u.slice(p+1));x.children=[];t=0;for(r=u.length;t<r;t++){x.add(u[t])}u=x.children}}}delete x.name;w["cke:list"]=1},assembleList:function(L){var J=L.children,K,G,I,H,D,C;L=[];for(var F,A,E,z,B,w,x=0;x<J.length;x++){if(K=J[x],"cke:li"==K.name){if(K.name="li",G=K.attributes,E=(E=G["cke:listsymbol"])&&E.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),z=B=w=null,G["cke:ignored"]){J.splice(x--,1)}else{G["cke:reset"]&&(C=H=D=null);I=Number(G["cke:indent"]);I!=H&&(A=F=null);if(E){if(A&&d[A][F].test(E[1])){z=A,B=F}else{for(var s in d){for(var o in d[s]){if(d[s][o].test(E[1])){if("ol"==s&&/alpha|roman/.test(o)){if(F=/roman/.test(o)?c(E[1]):l(E[1]),!w||F<w){w=F,z=s,B=o}}else{z=s;B=o;break}}}}}!z&&(z=E[2]?"ol":"ul")}else{z=G["cke:listtype"]||"ol",B=G["cke:list-style-type"]}A=z;F=B||("ol"==z?"decimal":"disc");B&&B!=("ol"==z?"decimal":"disc")&&K.addStyle("list-style-type",B);if("ol"==z&&E){switch(B){case"decimal":w=Number(E[1]);break;case"lower-roman":case"upper-roman":w=c(E[1]);break;case"lower-alpha":case"upper-alpha":w=l(E[1])}K.attributes.value=w}if(C){if(I>H){L.push(C=new CKEDITOR.htmlParser.element(z)),C.add(K),D.add(C)}else{if(I<H){H-=I;for(var r;H--&&(r=C.parent);){C=r.parent}}C.add(K)}J.splice(x--,1)}else{L.push(C=new CKEDITOR.htmlParser.element(z)),C.add(K),J[x]=C}D=K;H=I}}else{C&&(C=H=D=null)}}for(x=0;x<L.length;x++){if(C=L[x],s=C.children,F=F=void 0,o=C.children.length,r=F=void 0,J=/list-style-type:(.*?)(?:;|$)/,H=CKEDITOR.plugins.pastefromword.filters.stylesFilter,F=C.attributes,!J.exec(F.style)){for(D=0;D<o;D++){if(F=s[D],F.attributes.value&&Number(F.attributes.value)==D+1&&delete F.attributes.value,F=J.exec(F.attributes.style)){if(F[1]!=r&&r){r=null;break}else{r=F[1]}}}if(r){for(D=0;D<o;D++){F=s[D].attributes,F.style&&(F.style=H([["list-style-type"]])(F.style)||"")}C.addStyle("list-style-type",r)}}}e=g=h=null},falsyFilter:function(){return !1},stylesFilter:function(m,n){return function(o,p){var r=[];(o||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(t,x,v){x=x.toLowerCase();"font-family"==x&&(v=v.replace(/["']/g,""));for(var y,u,w,s=0;s<m.length;s++){if(m[s]&&(t=m[s][0],y=m[s][1],u=m[s][2],w=m[s][3],x.match(t)&&(!y||v.match(y)))){x=w||x;n&&(u=u||v);"function"==typeof u&&(u=u(v,p,x));u&&u.push&&(x=u[0],u=u[1]);"string"==typeof u&&r.push([x,u]);return}}!n&&r.push([x,v])});for(var q=0;q<r.length;q++){r[q]=r[q].join(":")}return r.length?r.join(";")+";":!1}},elementMigrateFilter:function(m,n){return m?function(o){var p=n?(new CKEDITOR.style(m,n))._.definition:m;o.name=p.element;CKEDITOR.tools.extend(o.attributes,CKEDITOR.tools.clone(p.attributes));o.addStyle(CKEDITOR.style.getStyleText(p));p.attributes&&p.attributes["class"]&&(o.classWhiteList=" "+p.attributes["class"]+" ")}:function(){}},styleMigrateFilter:function(n,o){var m=this.elementMigrateFilter;return n?function(q,s){var r=new CKEDITOR.htmlParser.element(null),p={};p[o]=q;m(n,p)(r);r.children=s.children;s.children=[r];r.filter=function(){};r.parent=s}:function(){}},bogusAttrFilter:function(m,n){if(-1==n.name.indexOf("cke:")){return !1}},applyStyleFilter:null},getRules:function(R,P){var Q=CKEDITOR.dtd,M=CKEDITOR.tools.extend({},Q.$block,Q.$listItem,Q.$tableContent),O=R.config,N=this.filters,J=N.falsyFilter,I=N.stylesFilter,L=N.elementMigrateFilter,G=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),K=this.utils.createListBulletMarker,F=N.flattenList,H=N.assembleList,C=this.utils.isListBulletIndicator,E=this.utils.isContainingOnlySpaces,B=this.utils.resolveList,o=function(m){m=CKEDITOR.tools.convertToPx(m);return isNaN(m)?m:m+"px"},A=this.utils.getStyleComponents,s=this.utils.listDtdParents,D=!1!==O.pasteFromWordRemoveFontStyles,z=!1!==O.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(m){m.filterChildren(P);H(m)},elements:{"^":function(m){var n;CKEDITOR.env.gecko&&(n=N.applyStyleFilter)&&n(m)},$:function(m){var p=m.name||"",n=m.attributes;p in M&&n.style&&(n.style=I([[/^(:?width|height)$/,null,o]])(n.style)||"");if(p.match(/h\d/)){m.filterChildren(P);if(B(m)){return}L(O["format_"+p])(m)}else{if(p in Q.$inline){m.filterChildren(P),E(m)&&delete m.name}else{if(-1!=p.indexOf(":")&&-1==p.indexOf("cke")){m.filterChildren(P);if("v:imagedata"==p){if(p=m.attributes["o:href"]){m.attributes.src=p}m.name="img";return}delete m.name}}}p in s&&(m.filterChildren(P),H(m))},style:function(m){if(CKEDITOR.env.gecko){m=(m=m.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&m[1];var n={};m&&(m.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(q,p,r){p=p.split(",");q=p.length;for(var t=0;t<q;t++){CKEDITOR.tools.trim(p[t]).replace(/^(\w+)(\.[\w-]+)?$/g,function(v,u,w){u=u||"*";w=w.substring(1,w.length);w.match(/MsoNormal/)||(n[u]||(n[u]={}),w?n[u][w]=r:n[u]=r)})}}),N.applyStyleFilter=function(q){var p=n["*"]?"*":q.name,r=q.attributes&&q.attributes["class"];p in n&&(p=n[p],"object"==typeof p&&(p=p[r]),p&&q.addStyle(p,!0))})}return !1},p:function(n){if(/MsoListParagraph/i.exec(n.attributes["class"])||n.getStyle("mso-list")&&!n.getStyle("mso-list").match(/^(none|skip)$/i)){var m=n.firstChild(function(p){return p.type==CKEDITOR.NODE_TEXT&&!E(p.parent)});(m=m&&m.parent)&&m.addStyle("mso-list","Ignore")}n.filterChildren(P);B(n)||(O.enterMode==CKEDITOR.ENTER_BR?(delete n.name,n.add(new CKEDITOR.htmlParser.element("br"))):L(O["format_"+(O.enterMode==CKEDITOR.ENTER_P?"p":"div")])(n))},div:function(n){var p=n.onlyChild();if(p&&"table"==p.name){var m=n.attributes;p.attributes=CKEDITOR.tools.extend(p.attributes,m);m.style&&p.addStyle(m.style);p=new CKEDITOR.htmlParser.element("div");p.addStyle("clear","both");n.add(p);delete n.name}},td:function(m){m.getAncestor("thead")&&(m.name="th")},ol:F,ul:F,dl:F,font:function(n){if(C(n.parent)){delete n.name}else{n.filterChildren(P);var m=n.attributes,q=m.style,p=n.parent;"font"==p.name?(CKEDITOR.tools.extend(p.attributes,n.attributes),q&&p.addStyle(q),delete n.name):(q=(q||"").split(";"),m.color&&("#000000"!=m.color&&q.push("color:"+m.color),delete m.color),m.face&&(q.push("font-family:"+m.face),delete m.face),m.size&&(q.push("font-size:"+(3<m.size?"large":3>m.size?"small":"medium")),delete m.size),n.name="span",n.addStyle(q.join(";")))}},span:function(n){if(C(n.parent)){return !1}n.filterChildren(P);if(E(n)){return delete n.name,null}if(C(n)){var m=n.firstChild(function(q){return q.value||"img"==q.name}),p=(m=m&&(m.value||"l."))&&m.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(p){return m=K(p,m),(n=n.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(n.attributes.style)&&(m.attributes["cke:ignored"]=1),m}}if(p=(m=n.attributes)&&m.style){m.style=I([["line-height"],[/^font-family$/,null,D?null:G(O.font_style,"family")],[/^font-size$/,null,D?null:G(O.fontSize_style,"size")],[/^color$/,null,D?null:G(O.colorButton_foreStyle,"color")],[/^background-color$/,null,D?null:G(O.colorButton_backStyle,"color")]])(p,n)||""}m.style||delete m.style;CKEDITOR.tools.isEmpty(m)&&delete n.name;return null},b:L(O.coreStyles_bold),i:L(O.coreStyles_italic),u:L(O.coreStyles_underline),s:L(O.coreStyles_strike),sup:L(O.coreStyles_superscript),sub:L(O.coreStyles_subscript),a:function(n){var m=n.attributes;m.name&&m.name.match(/ole_link\d+/i)?delete n.name:m.href&&m.href.match(/^file:\/\/\/[\S]+#/i)&&(m.href=m.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(m){m.getAncestor(/h\d/)&&!O.pasteFromWordNumberedHeadingToList&&delete m.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:I(z?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(n,m,p){if(m.name in {p:1,div:1}){m="ltr"==O.contentsLangDirection?"margin-left":"margin-right";if("margin"==p){n=A(p,n,[m])[m]}else{if(p!=m){return null}}if(n&&!j.test(n)){return[m,n]}}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(n,m){if("img"==m.name){return n}}],[/^width|height$/,null,function(n,m){if(m.name in {table:1,td:1,th:1,img:1}){return n}}]]:[[/^mso-/],[/-color$/,null,function(m){if("transparent"==m){return !1}if(CKEDITOR.env.gecko){return m.replace(/-moz-use-text-color/g,"transparent")}}],[/^margin$/,j],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],D?[/font-?/]:null],z),width:function(m,n){if(n.name in Q.$tableContent){return !1}},border:function(m,n){if(n.name in Q.$tableContent){return !1}},"class":function(n,m){return m.classWhiteList&&-1!=m.classWhiteList.indexOf(" "+n+" ")?n:!1},bgcolor:J,valign:z?J:function(n,m){m.addStyle("vertical-align",n);return !1}},comment:CKEDITOR.env.ie?J:function(n,m){var q=n.match(/<img.*?>/),p=n.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return p?(p=(q=p[1]||q&&"l.")&&q.match(/>(?:[(]?)([^\s]+?)([.)]?)</),K(p,q)):CKEDITOR.env.gecko&&q?(q=CKEDITOR.htmlParser.fragment.fromHtml(q[0]).children[0],(p=(p=(p=m.previous)&&p.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&p[1])&&(q.attributes.src=p),q):!1}}}},f=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};f.prototype={toHtml:function(m){m=CKEDITOR.htmlParser.fragment.fromHtml(m);var n=new CKEDITOR.htmlParser.basicWriter;m.writeHtml(n,this.dataFilter);return n.getHtml(!0)}};CKEDITOR.cleanWord=function(n,q){n=n.replace(/<!\[([^\]]*?)\]>/g,"\x3c!--[$1]--\x3e");CKEDITOR.env.gecko&&(n=n.replace(/(\x3c!--\[if[^<]*?\])--\x3e([\S\s]*?)\x3c!--(\[endif\]--\x3e)/gi,"$1$2$3"));CKEDITOR.env.webkit&&(n=n.replace(/(class="MsoListParagraph[^>]+>\x3c!--\[if !supportLists\]--\x3e)([^<]+<span[^<]+<\/span>)(\x3c!--\[endif\]--\x3e)/gi,"$1\x3cspan\x3e$2\x3c/span\x3e$3"));var m=new f,o=m.dataFilter;o.addRules(CKEDITOR.plugins.pastefromword.getRules(q,o));q.fire("beforeCleanWord",{filter:o});try{n=m.toHtml(n)}catch(p){q.showNotification(q.lang.pastefromword.error)}n=n.replace(/cke:.*?".*?"/g,"");n=n.replace(/style=""/g,"");return n=n.replace(/<span>/g,"")}})();