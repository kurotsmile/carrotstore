(function(){function v(f){f=f.toUpperCase();for(var b=x.length,a=0,e=0;e<b;++e){for(var c=x[e],d=c[1].length;f.substr(0,d)==c[1];f=f.substr(d)){a+=c[0]}}return a}function m(c){c=c.toUpperCase();for(var b=1,a=1;0<c.length;a*=26){b+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(c.charAt(c.length-1))*a,c=c.substr(0,c.length-1)}return b}var n=CKEDITOR.htmlParser.fragment.prototype,w=CKEDITOR.htmlParser.element.prototype;n.onlyChild=w.onlyChild=function(){var a=this.children;return 1==a.length&&a[0]||null};w.removeAnyChildWithName=function(e){for(var b=this.children,a=[],d,c=0;c<b.length;c++){d=b[c],d.name&&(d.name==e&&(a.push(d),b.splice(c--,1)),a=a.concat(d.removeAnyChildWithName(e)))}return a};w.getAncestor=function(a){for(var b=this.parent;b&&(!b.name||!b.name.match(a));){b=b.parent}return b};n.firstChild=w.firstChild=function(c){for(var b,a=0;a<this.children.length;a++){if(b=this.children[a],c(b)||b.name&&(b=b.firstChild(c))){return b}}return null};w.addStyle=function(e,b,a){var d="";if("string"==typeof b){d+=e+":"+b+";"}else{if("object"==typeof e){for(var c in e){e.hasOwnProperty(c)&&(d+=c+":"+e[c]+";")}}else{d+=e}a=b}this.attributes||(this.attributes={});e=this.attributes.style||"";e=(a?[d,e]:[e,d]).join(";");this.attributes.style=e.replace(/^;+|;(?=;)/g,"")};w.getStyle=function(a){var b=this.attributes.style;if(b){return b=CKEDITOR.tools.parseCssText(b,1),b[a]}};CKEDITOR.dtd.parentOf=function(c){var b={},a;for(a in this){-1==a.indexOf("$")&&this[a][c]&&(b[a]=1)}return b};var o=/^(?:\b0[^\s]*\s*){1,4}$/,u={ol:{decimal:/\d+/,"lower-roman":/^m{0,4}(cm|cd|d?c{0,3})(xc|xl|l?x{0,3})(ix|iv|v?i{0,3})$/,"upper-roman":/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,"lower-alpha":/^[a-z]+$/,"upper-alpha":/^[A-Z]+$/},ul:{disc:/[l\u00B7\u2002]/,circle:/[\u006F\u00D8]/,square:/[\u006E\u25C6]/}},x=[[1000,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],q=0,r=null,t,p=CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(c,b){var a=new CKEDITOR.htmlParser.element("cke:listbullet");a.attributes={"cke:listsymbol":c[0]};a.add(new CKEDITOR.htmlParser.text(b));return a},isListBulletIndicator:function(a){if(/mso-list\s*:\s*Ignore/i.test(a.attributes&&a.attributes.style)){return !0}},isContainingOnlySpaces:function(a){var b;return(b=a.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(b.value)},resolveList:function(c){var b=c.attributes,a;if((a=c.removeAnyChildWithName("cke:listbullet"))&&a.length&&(a=a[0])){return c.name="cke:li",b.style&&(b.style=p.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(d){d=d.split(" ");d=CKEDITOR.tools.convertToPx(d[3]||d[1]||d[0]);!q&&null!==r&&d>r&&(q=d-r);r=d;b["cke:indent"]=q&&Math.ceil(d/q)+1||1}],[/^mso-list$/,null,function(d){d=d.split(" ");if(!(2>d.length)){var e=Number(d[0].match(/\d+/));d=Number(d[1].match(/\d+/));1==d&&(e!==t&&(b["cke:reset"]=1),t=e);b["cke:indent"]=d}}]])(b.style,c)||""),b["cke:indent"]||(r=0,b["cke:indent"]=1),CKEDITOR.tools.extend(b,a.attributes),!0}t=r=q=null;return !1},getStyleComponents:function(){var a=CKEDITOR.dom.element.createFromHtml('\x3cdiv style\x3d"position:absolute;left:-9999px;top:-9999px;"\x3e\x3c/div\x3e',CKEDITOR.document);CKEDITOR.document.getBody().append(a);return function(b,e,d){a.setStyle(b,e);b={};e=d.length;for(var c=0;c<e;c++){b[d[c]]=a.getStyle(d[c])}return b}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(f,h){h="number"==typeof h?h:1;var g=f.attributes,k;switch(g.type){case"a":k="lower-alpha";break;case"1":k="decimal"}for(var i=f.children,j,c=0;c<i.length;c++){if(j=i[c],j.name in CKEDITOR.dtd.$listItem){var d=j.attributes,a=j.children,e=a[0],b=a[a.length-1];e.attributes&&e.attributes.style&&-1<e.attributes.style.indexOf("mso-list")&&(j.attributes.style=e.attributes.style,e.replaceWithChildren());b.name in CKEDITOR.dtd.$list&&(f.add(b,c+1),--a.length||i.splice(c--,1));j.name="cke:li";g.start&&!c&&(d.value=g.start);p.filters.stylesFilter([["tab-stops",null,function(l){(l=l.match(/0$|\d+\.?\d*\w+/))&&(r=CKEDITOR.tools.convertToPx(l[0]))}],1==h?["mso-list",null,function(l){l=l.split(" ");l=Number(l[0].match(/\d+/));l!==t&&(d["cke:reset"]=1);t=l}]:null])(d.style);d["cke:indent"]=h;d["cke:listtype"]=f.name;d["cke:list-style-type"]=k}else{if(j.name in CKEDITOR.dtd.$list){arguments.callee.apply(this,[j,h+1]);i=i.slice(0,c).concat(j.children).concat(i.slice(c+1));f.children=[];j=0;for(a=i.length;j<a;j++){f.add(i[j])}i=f.children}}}delete f.name;g["cke:list"]=1},assembleList:function(a){var d=a.children,b,i,e,g,y,N;a=[];for(var j,P,k,c,O,h,f=0;f<d.length;f++){if(b=d[f],"cke:li"==b.name){if(b.name="li",i=b.attributes,k=(k=i["cke:listsymbol"])&&k.match(/^(?:[(]?)([^\s]+?)([.)]?)$/),c=O=h=null,i["cke:ignored"]){d.splice(f--,1)}else{i["cke:reset"]&&(N=g=y=null);e=Number(i["cke:indent"]);e!=g&&(P=j=null);if(k){if(P&&u[P][j].test(k[1])){c=P,O=j}else{for(var l in u){for(var Q in u[l]){if(u[l][Q].test(k[1])){if("ol"==l&&/alpha|roman/.test(Q)){if(j=/roman/.test(Q)?v(k[1]):m(k[1]),!h||j<h){h=j,c=l,O=Q}}else{c=l;O=Q;break}}}}}!c&&(c=k[2]?"ol":"ul")}else{c=i["cke:listtype"]||"ol",O=i["cke:list-style-type"]}P=c;j=O||("ol"==c?"decimal":"disc");O&&O!=("ol"==c?"decimal":"disc")&&b.addStyle("list-style-type",O);if("ol"==c&&k){switch(O){case"decimal":h=Number(k[1]);break;case"lower-roman":case"upper-roman":h=v(k[1]);break;case"lower-alpha":case"upper-alpha":h=m(k[1])}b.attributes.value=h}if(N){if(e>g){a.push(N=new CKEDITOR.htmlParser.element(c)),N.add(b),y.add(N)}else{if(e<g){g-=e;for(var M;g--&&(M=N.parent);){N=M.parent}}N.add(b)}d.splice(f--,1)}else{a.push(N=new CKEDITOR.htmlParser.element(c)),N.add(b),d[f]=N}y=b;g=e}}else{N&&(N=g=y=null)}}for(f=0;f<a.length;f++){if(N=a[f],l=N.children,j=j=void 0,Q=N.children.length,M=j=void 0,d=/list-style-type:(.*?)(?:;|$)/,g=CKEDITOR.plugins.pastefromword.filters.stylesFilter,j=N.attributes,!d.exec(j.style)){for(y=0;y<Q;y++){if(j=l[y],j.attributes.value&&Number(j.attributes.value)==y+1&&delete j.attributes.value,j=d.exec(j.attributes.style)){if(j[1]!=M&&M){M=null;break}else{M=j[1]}}}if(M){for(y=0;y<Q;y++){j=l[y].attributes,j.style&&(j.style=g([["list-style-type"]])(j.style)||"")}N.addStyle("list-style-type",M)}}}t=r=q=null},falsyFilter:function(){return !1},stylesFilter:function(a,b){return function(f,e){var c=[];(f||"").replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(k,g,i){g=g.toLowerCase();"font-family"==g&&(i=i.replace(/["']/g,""));for(var z,j,h,l=0;l<a.length;l++){if(a[l]&&(k=a[l][0],z=a[l][1],j=a[l][2],h=a[l][3],g.match(k)&&(!z||i.match(z)))){g=h||g;b&&(j=j||i);"function"==typeof j&&(j=j(i,e,g));j&&j.push&&(g=j[0],j=j[1]);"string"==typeof j&&c.push([g,j]);return}}!b&&c.push([g,i])});for(var d=0;d<c.length;d++){c[d]=c[d].join(":")}return c.length?c.join(";")+";":!1}},elementMigrateFilter:function(a,b){return a?function(d){var c=b?(new CKEDITOR.style(a,b))._.definition:a;d.name=c.element;CKEDITOR.tools.extend(d.attributes,CKEDITOR.tools.clone(c.attributes));d.addStyle(CKEDITOR.style.getStyleText(c));c.attributes&&c.attributes["class"]&&(d.classWhiteList=" "+c.attributes["class"]+" ")}:function(){}},styleMigrateFilter:function(c,b){var a=this.elementMigrateFilter;return c?function(f,d){var e=new CKEDITOR.htmlParser.element(null),g={};g[b]=f;a(c,g)(e);e.children=d.children;d.children=[e];e.filter=function(){};e.parent=d}:function(){}},bogusAttrFilter:function(a,b){if(-1==b.name.indexOf("cke:")){return !1}},applyStyleFilter:null},getRules:function(a,c){var b=CKEDITOR.dtd,f=CKEDITOR.tools.extend({},b.$block,b.$listItem,b.$tableContent),d=a.config,e=this.filters,j=e.falsyFilter,k=e.stylesFilter,g=e.elementMigrateFilter,y=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),i=this.utils.createListBulletMarker,S=e.flattenList,l=e.assembleList,W=this.utils.isListBulletIndicator,T=this.utils.isContainingOnlySpaces,X=this.utils.resolveList,Z=function(z){z=CKEDITOR.tools.convertToPx(z);return isNaN(z)?z:z+"px"},Y=this.utils.getStyleComponents,V=this.utils.listDtdParents,U=!1!==d.pasteFromWordRemoveFontStyles,h=!1!==d.pasteFromWordRemoveStyles;return{elementNames:[[/meta|link|script/,""]],root:function(z){z.filterChildren(c);l(z)},elements:{"^":function(z){var A;CKEDITOR.env.gecko&&(A=e.applyStyleFilter)&&A(z)},$:function(z){var A=z.name||"",B=z.attributes;A in f&&B.style&&(B.style=k([[/^(:?width|height)$/,null,Z]])(B.style)||"");if(A.match(/h\d/)){z.filterChildren(c);if(X(z)){return}g(d["format_"+A])(z)}else{if(A in b.$inline){z.filterChildren(c),T(z)&&delete z.name}else{if(-1!=A.indexOf(":")&&-1==A.indexOf("cke")){z.filterChildren(c);if("v:imagedata"==A){if(A=z.attributes["o:href"]){z.attributes.src=A}z.name="img";return}delete z.name}}}A in V&&(z.filterChildren(c),l(z))},style:function(z){if(CKEDITOR.env.gecko){z=(z=z.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/))&&z[1];var A={};z&&(z.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(D,E,C){E=E.split(",");D=E.length;for(var B=0;B<D;B++){CKEDITOR.tools.trim(E[B]).replace(/^(\w+)(\.[\w-]+)?$/g,function(G,H,F){H=H||"*";F=F.substring(1,F.length);F.match(/MsoNormal/)||(A[H]||(A[H]={}),F?A[H][F]=C:A[H]=C)})}}),e.applyStyleFilter=function(C){var D=A["*"]?"*":C.name,B=C.attributes&&C.attributes["class"];D in A&&(D=A[D],"object"==typeof D&&(D=D[B]),D&&C.addStyle(D,!0))})}return !1},p:function(A){if(/MsoListParagraph/i.exec(A.attributes["class"])||A.getStyle("mso-list")&&!A.getStyle("mso-list").match(/^(none|skip)$/i)){var z=A.firstChild(function(B){return B.type==CKEDITOR.NODE_TEXT&&!T(B.parent)});(z=z&&z.parent)&&z.addStyle("mso-list","Ignore")}A.filterChildren(c);X(A)||(d.enterMode==CKEDITOR.ENTER_BR?(delete A.name,A.add(new CKEDITOR.htmlParser.element("br"))):g(d["format_"+(d.enterMode==CKEDITOR.ENTER_P?"p":"div")])(A))},div:function(B){var A=B.onlyChild();if(A&&"table"==A.name){var z=B.attributes;A.attributes=CKEDITOR.tools.extend(A.attributes,z);z.style&&A.addStyle(z.style);A=new CKEDITOR.htmlParser.element("div");A.addStyle("clear","both");B.add(A);delete B.name}},td:function(z){z.getAncestor("thead")&&(z.name="th")},ol:S,ul:S,dl:S,font:function(C){if(W(C.parent)){delete C.name}else{C.filterChildren(c);var z=C.attributes,A=z.style,B=C.parent;"font"==B.name?(CKEDITOR.tools.extend(B.attributes,C.attributes),A&&B.addStyle(A),delete C.name):(A=(A||"").split(";"),z.color&&("#000000"!=z.color&&A.push("color:"+z.color),delete z.color),z.face&&(A.push("font-family:"+z.face),delete z.face),z.size&&(A.push("font-size:"+(3<z.size?"large":3>z.size?"small":"medium")),delete z.size),C.name="span",C.addStyle(A.join(";")))}},span:function(B){if(W(B.parent)){return !1}B.filterChildren(c);if(T(B)){return delete B.name,null}if(W(B)){var z=B.firstChild(function(C){return C.value||"img"==C.name}),A=(z=z&&(z.value||"l."))&&z.match(/^(?:[(]?)([^\s]+?)([.)]?)$/);if(A){return z=i(A,z),(B=B.getAncestor("span"))&&/ mso-hide:\s*all|display:\s*none /.test(B.attributes.style)&&(z.attributes["cke:ignored"]=1),z}}if(A=(z=B.attributes)&&z.style){z.style=k([["line-height"],[/^font-family$/,null,U?null:y(d.font_style,"family")],[/^font-size$/,null,U?null:y(d.fontSize_style,"size")],[/^color$/,null,U?null:y(d.colorButton_foreStyle,"color")],[/^background-color$/,null,U?null:y(d.colorButton_backStyle,"color")]])(A,B)||""}z.style||delete z.style;CKEDITOR.tools.isEmpty(z)&&delete B.name;return null},b:g(d.coreStyles_bold),i:g(d.coreStyles_italic),u:g(d.coreStyles_underline),s:g(d.coreStyles_strike),sup:g(d.coreStyles_superscript),sub:g(d.coreStyles_subscript),a:function(A){var z=A.attributes;z.name&&z.name.match(/ole_link\d+/i)?delete A.name:z.href&&z.href.match(/^file:\/\/\/[\S]+#/i)&&(z.href=z.href.replace(/^file:\/\/\/[^#]+/i,""))},"cke:listbullet":function(z){z.getAncestor(/h\d/)&&!d.pasteFromWordNumberedHeadingToList&&delete z.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:k(h?[[/^list-style-type$/,null],[/^margin$|^margin-(?!bottom|top)/,null,function(B,z,A){if(z.name in {p:1,div:1}){z="ltr"==d.contentsLangDirection?"margin-left":"margin-right";if("margin"==A){B=Y(A,B,[z])[z]}else{if(A!=z){return null}}if(B&&!o.test(B)){return[z,B]}}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(A,z){if("img"==z.name){return A}}],[/^width|height$/,null,function(A,z){if(z.name in {table:1,td:1,th:1,img:1}){return A}}]]:[[/^mso-/],[/-color$/,null,function(z){if("transparent"==z){return !1}if(CKEDITOR.env.gecko){return z.replace(/-moz-use-text-color/g,"transparent")}}],[/^margin$/,o],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],U?[/font-?/]:null],h),width:function(z,A){if(A.name in b.$tableContent){return !1}},border:function(z,A){if(A.name in b.$tableContent){return !1}},"class":function(A,z){return z.classWhiteList&&-1!=z.classWhiteList.indexOf(" "+A+" ")?A:!1},bgcolor:j,valign:h?j:function(A,z){z.addStyle("vertical-align",A);return !1}},comment:CKEDITOR.env.ie?j:function(C,z){var A=C.match(/<img.*?>/),B=C.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/);return B?(B=(A=B[1]||A&&"l.")&&A.match(/>(?:[(]?)([^\s]+?)([.)]?)</),i(B,A)):CKEDITOR.env.gecko&&A?(A=CKEDITOR.htmlParser.fragment.fromHtml(A[0]).children[0],(B=(B=(B=z.previous)&&B.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/))&&B[1])&&(A.attributes.src=B),A):!1}}}},s=function(){this.dataFilter=new CKEDITOR.htmlParser.filter};s.prototype={toHtml:function(a){a=CKEDITOR.htmlParser.fragment.fromHtml(a);var b=new CKEDITOR.htmlParser.basicWriter;a.writeHtml(b,this.dataFilter);return b.getHtml(!0)}};CKEDITOR.cleanWord=function(e,b){e=e.replace(/<!\[([^\]]*?)\]>/g,"\x3c!--[$1]--\x3e");CKEDITOR.env.gecko&&(e=e.replace(/(\x3c!--\[if[^<]*?\])--\x3e([\S\s]*?)\x3c!--(\[endif\]--\x3e)/gi,"$1$2$3"));CKEDITOR.env.webkit&&(e=e.replace(/(class="MsoListParagraph[^>]+>\x3c!--\[if !supportLists\]--\x3e)([^<]+<span[^<]+<\/span>)(\x3c!--\[endif\]--\x3e)/gi,"$1\x3cspan\x3e$2\x3c/span\x3e$3"));var a=new s,d=a.dataFilter;d.addRules(CKEDITOR.plugins.pastefromword.getRules(b,d));b.fire("beforeCleanWord",{filter:d});try{e=a.toHtml(e)}catch(c){b.showNotification(b.lang.pastefromword.error)}e=e.replace(/cke:.*?".*?"/g,"");e=e.replace(/style=""/g,"");return e=e.replace(/<span>/g,"")}})();