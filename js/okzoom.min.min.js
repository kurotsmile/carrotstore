$(function(b){b.fn.okzoom=function(a){return a=b.extend({},b.fn.okzoom.defaults,a),this.each(function(){var l={},k=this;l.options=a,l.$el=b(k),l.el=k,l.listener=document.createElement("div"),l.$listener=b(l.listener).addClass("ok-listener").css({position:"absolute",zIndex:10000}),b("body").append(l.$listener);var j=document.createElement("div");if(j.id="ok-loupe",j.style.position="absolute",j.style.backgroundRepeat="no-repeat",j.style.pointerEvents="none",j.style.display="none",j.style.zIndex=7879,b("body").append(j),l.loupe=j,l.$el.data("okzoom",l),l.options=a,b(l.el).bind("mouseover",function(c){return function(d){b.fn.okzoom.build(c,d)}}(l)),l.$listener.bind("mousemove",function(c){return function(d){b.fn.okzoom.mousemove(c,d)}}(l)),l.$listener.bind("mouseout",function(c){return function(d){b.fn.okzoom.mouseout(c,d)}}(l)),l.options.height=l.options.height||l.options.width,l.image_from_data=l.$el.data("okimage"),l.has_data_image="undefined"!=typeof l.image_from_data,l.has_data_image&&(l.img=new Image,l.img.src=l.image_from_data),l.msie=-1,"Microsoft Internet Explorer"==navigator.appName){var i=navigator.userAgent,h=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=h.exec(i)&&(l.msie=parseFloat(RegExp.$1))}})},b.fn.okzoom.defaults={width:150,height:null,scaleWidth:null,round:!0,background:"#fff",backgroundRepeat:"no-repeat",shadow:"0 0 5px #000",border:0},b.fn.okzoom.build=function(a,f){if(a.has_data_image?a.image_from_data!=a.$el.attr("data-okimage")&&(a.image_from_data=a.$el.attr("data-okimage"),b(a.img).remove(),a.img=new Image,a.img.src=a.image_from_data):a.img=a.el,a.msie>-1&&a.msie<9&&!a.img.naturalized){var e=function(d){d=d||this;var c=new Image;c.el=d,c.src=d.src,d.naturalWidth=c.width,d.naturalHeight=c.height,d.naturalized=!0};if(!a.img.complete){return}e(a.img)}a.offset=a.$el.offset(),a.width=a.$el.width(),a.height=a.$el.height(),a.$listener.css({display:"block",width:a.$el.outerWidth(),height:a.$el.outerHeight(),top:a.$el.offset().top,left:a.$el.offset().left}),a.options.scaleWidth?(a.naturalWidth=a.options.scaleWidth,a.naturalHeight=Math.round(a.img.naturalHeight*a.options.scaleWidth/a.img.naturalWidth)):(a.naturalWidth=a.img.naturalWidth,a.naturalHeight=a.img.naturalHeight),a.widthRatio=a.naturalWidth/a.width,a.heightRatio=a.naturalHeight/a.height,a.loupe.style.width=a.options.width+"px",a.loupe.style.height=a.options.height+"px",a.loupe.style.border=a.options.border,a.loupe.style.background=a.options.background+" url("+a.img.src+")",a.loupe.style.backgroundRepeat=a.options.backgroundRepeat,a.loupe.style.backgroundSize=a.options.scaleWidth?a.naturalWidth+"px "+a.naturalHeight+"px":"auto",a.loupe.style.borderRadius=a.loupe.style.OBorderRadius=a.loupe.style.MozBorderRadius=a.loupe.style.WebkitBorderRadius=a.options.round?a.options.width+"px":0,a.loupe.style.boxShadow=a.options.shadow,a.initialized=!0,b.fn.okzoom.mousemove(a,f)},b.fn.okzoom.mousemove=function(j,i){if(j.initialized){var p=j.options.width/2,o=j.options.height/2,n="undefined"!=typeof i.pageX?i.pageX:i.clientX+document.documentElement.scrollLeft,m="undefined"!=typeof i.pageY?i.pageY:i.clientY+document.documentElement.scrollTop,l=-1*Math.floor((n-j.offset.left)*j.widthRatio-p),k=-1*Math.floor((m-j.offset.top)*j.heightRatio-o);document.body.style.cursor="none",j.loupe.style.display="block",j.loupe.style.left=n-p+"px",j.loupe.style.top=m-o+"px",j.loupe.style.backgroundPosition=l+"px "+k+"px"}},b.fn.okzoom.mouseout=function(c){c.loupe.style.display="none",c.loupe.style.background="none",c.listener.style.display="none",document.body.style.cursor="auto"}});