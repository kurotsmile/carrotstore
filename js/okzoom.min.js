$(function(a){a.fn.okzoom=function(b){b=a.extend({},a.fn.okzoom.defaults,b);return this.each(function(){var g={};var f=this;g.options=b;g.$el=a(f);g.el=f;g.listener=document.createElement("div");g.$listener=a(g.listener).addClass("ok-listener").css({position:"absolute",zIndex:10000});a("body").append(g.$listener);var c=document.createElement("div");c.id="ok-loupe";c.style.position="absolute";c.style.backgroundRepeat="no-repeat";c.style.pointerEvents="none";c.style.display="none";c.style.zIndex=7879;a("body").append(c);g.loupe=c;g.$el.data("okzoom",g);g.options=b;a(g.el).bind("mouseover",(function(h){return function(i){a.fn.okzoom.build(h,i)}}(g)));g.$listener.bind("mousemove",(function(h){return function(i){a.fn.okzoom.mousemove(h,i)}}(g)));g.$listener.bind("mouseout",(function(h){return function(i){a.fn.okzoom.mouseout(h,i)}}(g)));g.options.height=g.options.height||g.options.width;g.image_from_data=g.$el.data("okimage");g.has_data_image=typeof g.image_from_data!=="undefined";if(g.has_data_image){g.img=new Image();g.img.src=g.image_from_data}g.msie=-1;if(navigator.appName=="Microsoft Internet Explorer"){var d=navigator.userAgent;var e=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(e.exec(d)!=null){g.msie=parseFloat(RegExp.$1)}}})};a.fn.okzoom.defaults={width:150,height:null,scaleWidth:null,round:true,background:"#fff",backgroundRepeat:"no-repeat",shadow:"0 0 5px #000",border:0};a.fn.okzoom.build=function(c,d){if(!c.has_data_image){c.img=c.el}else{if(c.image_from_data!=c.$el.attr("data-okimage")){c.image_from_data=c.$el.attr("data-okimage");a(c.img).remove();c.img=new Image();c.img.src=c.image_from_data}}if(c.msie>-1&&c.msie<9&&!c.img.naturalized){var b=function(e){e=e||this;var f=new Image();f.el=e;f.src=e.src;e.naturalWidth=f.width;e.naturalHeight=f.height;e.naturalized=true};if(c.img.complete){b(c.img)}else{return}}c.offset=c.$el.offset();c.width=c.$el.width();c.height=c.$el.height();c.$listener.css({display:"block",width:c.$el.outerWidth(),height:c.$el.outerHeight(),top:c.$el.offset().top,left:c.$el.offset().left});if(c.options.scaleWidth){c.naturalWidth=c.options.scaleWidth;c.naturalHeight=Math.round(c.img.naturalHeight*c.options.scaleWidth/c.img.naturalWidth)}else{c.naturalWidth=c.img.naturalWidth;c.naturalHeight=c.img.naturalHeight}c.widthRatio=c.naturalWidth/c.width;c.heightRatio=c.naturalHeight/c.height;c.loupe.style.width=c.options.width+"px";c.loupe.style.height=c.options.height+"px";c.loupe.style.border=c.options.border;c.loupe.style.background=c.options.background+" url("+c.img.src+")";c.loupe.style.backgroundRepeat=c.options.backgroundRepeat;c.loupe.style.backgroundSize=c.options.scaleWidth?c.naturalWidth+"px "+c.naturalHeight+"px":"auto";c.loupe.style.borderRadius=c.loupe.style.OBorderRadius=c.loupe.style.MozBorderRadius=c.loupe.style.WebkitBorderRadius=c.options.round?c.options.width+"px":0;c.loupe.style.boxShadow=c.options.shadow;c.initialized=true;a.fn.okzoom.mousemove(c,d)};a.fn.okzoom.mousemove=function(i,j){if(!i.initialized){return}var c=i.options.width/2;var b=i.options.height/2;var g=typeof j.pageX!=="undefined"?j.pageX:(j.clientX+document.documentElement.scrollLeft);var f=typeof j.pageY!=="undefined"?j.pageY:(j.clientY+document.documentElement.scrollTop);var d=-1*Math.floor((g-i.offset.left)*i.widthRatio-c);var h=-1*Math.floor((f-i.offset.top)*i.heightRatio-b);document.body.style.cursor="none";i.loupe.style.display="block";i.loupe.style.left=g-c+"px";i.loupe.style.top=f-b+"px";i.loupe.style.backgroundPosition=d+"px "+h+"px"};a.fn.okzoom.mouseout=function(b,c){b.loupe.style.display="none";b.loupe.style.background="none";b.listener.style.display="none";document.body.style.cursor="auto"}});