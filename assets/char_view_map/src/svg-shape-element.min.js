jvm.SVGShapeElement=function(b,a,c){jvm.SVGShapeElement.parentClass.call(this,b,a);jvm.AbstractShapeElement.apply(this,arguments)};jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement);jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement);jvm.SVGShapeElement.prototype.applyAttr=function(a,c){var d,e,b=this;if(a==="fill"&&jvm.isImageUrl(c)){if(!jvm.SVGShapeElement.images[c]){jvm.whenImageLoaded(c).then(function(f){e=new jvm.SVGElement("image");e.node.setAttributeNS("http://www.w3.org/1999/xlink","href",c);e.applyAttr("x","0");e.applyAttr("y","0");e.applyAttr("width",f[0].width);e.applyAttr("height",f[0].height);d=new jvm.SVGElement("pattern");d.applyAttr("id","image"+jvm.SVGShapeElement.imageCounter);d.applyAttr("x",0);d.applyAttr("y",0);d.applyAttr("width",f[0].width/2);d.applyAttr("height",f[0].height/2);d.applyAttr("viewBox","0 0 "+f[0].width+" "+f[0].height);d.applyAttr("patternUnits","userSpaceOnUse");d.node.appendChild(e.node);b.canvas.defsElement.node.appendChild(d.node);jvm.SVGShapeElement.images[c]=jvm.SVGShapeElement.imageCounter++;b.applyAttr("fill","url(#image"+jvm.SVGShapeElement.images[c]+")")})}else{this.applyAttr("fill","url(#image"+jvm.SVGShapeElement.images[c]+")")}}else{jvm.SVGShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}};jvm.SVGShapeElement.imageCounter=1;jvm.SVGShapeElement.images={};