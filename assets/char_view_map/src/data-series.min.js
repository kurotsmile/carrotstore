jvm.DataSeries=function(d,b,c){var a;d=d||{};d.attribute=d.attribute||"fill";this.elements=b;this.params=d;this.map=c;if(d.attributes){this.setAttributes(d.attributes)}if(jvm.$.isArray(d.scale)){a=(d.attribute==="fill"||d.attribute==="stroke")?jvm.ColorScale:jvm.NumericScale;this.scale=new a(d.scale,d.normalizeFunction,d.min,d.max)}else{if(d.scale){this.scale=new jvm.OrdinalScale(d.scale)}else{this.scale=new jvm.SimpleScale(d.scale)}}this.values=d.values||{};this.setValues(this.values);if(this.params.legend){this.legend=new jvm.Legend($.extend({map:this.map,series:this},this.params.legend))}};jvm.DataSeries.prototype={setAttributes:function(c,a){var b=c,d;if(typeof c=="string"){if(this.elements[c]){this.elements[c].setStyle(this.params.attribute,a)}}else{for(d in b){if(this.elements[d]){this.elements[d].element.setStyle(this.params.attribute,b[d])}}}},setValues:function(b){var a=-Number.MAX_VALUE,d=Number.MAX_VALUE,e,f,c={};if(!(this.scale instanceof jvm.OrdinalScale)&&!(this.scale instanceof jvm.SimpleScale)){if(typeof this.params.min==="undefined"||typeof this.params.max==="undefined"){for(f in b){e=parseFloat(b[f]);if(e>a){a=e}if(e<d){d=e}}}if(typeof this.params.min==="undefined"){this.scale.setMin(d);this.params.min=d}else{this.scale.setMin(this.params.min)}if(typeof this.params.max==="undefined"){this.scale.setMax(a);this.params.max=a}else{this.scale.setMax(this.params.max)}for(f in b){if(f!="indexOf"){e=parseFloat(b[f]);if(!isNaN(e)){c[f]=this.scale.getValue(e)}else{c[f]=this.elements[f].element.style.initial[this.params.attribute]}}}}else{for(f in b){if(b[f]){c[f]=this.scale.getValue(b[f])}else{c[f]=this.elements[f].element.style.initial[this.params.attribute]}}}this.setAttributes(c);jvm.$.extend(this.values,b)},clear:function(){var b,a={};for(b in this.values){if(this.elements[b]){a[b]=this.elements[b].element.shape.style.initial[this.params.attribute]}}this.setAttributes(a);this.values={}},setScale:function(a){this.scale.setScale(a);if(this.values){this.setValues(this.values)}},setNormalizeFunction:function(a){this.scale.setNormalizeFunction(a);if(this.values){this.setValues(this.values)}}};